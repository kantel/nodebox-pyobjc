
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Calculus &#8212; SymPy 1.1.1 documentation</title>
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://live.sympy.org/static/live-core.css" type="text/css" />
    <link rel="stylesheet" href="http://live.sympy.org/static/live-autocomplete.css" type="text/css" />
    <link rel="stylesheet" href="http://live.sympy.org/static/live-sphinx.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/utilities.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/external/classy.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/live-core.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/live-autocomplete.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/live-sphinx.js"></script>
    <link rel="shortcut icon" href="../../_static/sympy-notailtext-favicon.ico"/>
    <link href="http://docs.sympy.org/latest/modules/calculus/index.html" rel="canonical" />
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Physics Module" href="../physics/index.html" />
    <link rel="prev" title="Parsing input" href="../parsing.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../physics/index.html" title="Physics Module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../parsing.html" title="Parsing input"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">SymPy 1.1.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">SymPy Modules Reference</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-sympy.calculus">
<span id="calculus"></span><h1>Calculus<a class="headerlink" href="#module-sympy.calculus" title="Permalink to this headline">¶</a></h1>
<p>Calculus-related methods.</p>
<span class="target" id="module-sympy.calculus.euler"></span><p>This module implements a method to find
Euler-Lagrange Equations for given Lagrangian.</p>
<dl class="function">
<dt id="sympy.calculus.euler.euler_equations">
<code class="descclassname">sympy.calculus.euler.</code><code class="descname">euler_equations</code><span class="sig-paren">(</span><em>L</em>, <em>funcs=()</em>, <em>vars=()</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sympy/calculus/euler.html#euler_equations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.calculus.euler.euler_equations" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the Euler-Lagrange equations <a class="reference internal" href="#r22" id="id1">[R22]</a> for a given Lagrangian.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>L</strong> : Expr</p>
<blockquote>
<div><p>The Lagrangian that should be a function of the functions listed
in the second argument and their derivatives.</p>
<p>For example, in the case of two functions <span class="math">\(f(x,y)\)</span>, <span class="math">\(g(x,y)\)</span> and
two independent variables <span class="math">\(x\)</span>, <span class="math">\(y\)</span> the Lagrangian would have the form:</p>
<blockquote>
<div><div class="math">
\[L\left(f(x,y),g(x,y),\frac{\partial f(x,y)}{\partial x},
\frac{\partial f(x,y)}{\partial y},
\frac{\partial g(x,y)}{\partial x},
\frac{\partial g(x,y)}{\partial y},x,y\right)\]</div>
</div></blockquote>
<p>In many cases it is not necessary to provide anything, except the
Lagrangian, it will be auto-detected (and an error raised if this
couldn’t be done).</p>
</div></blockquote>
<p><strong>funcs</strong> : Function or an iterable of Functions</p>
<blockquote>
<div><p>The functions that the Lagrangian depends on. The Euler equations
are differential equations for each of these functions.</p>
</div></blockquote>
<p><strong>vars</strong> : Symbol or an iterable of Symbols</p>
<blockquote>
<div><p>The Symbols that are the independent variables of the functions.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>eqns</strong> : list of Eq</p>
<blockquote class="last">
<div><p>The list of differential equations, one for each function.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r22" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[R22]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>)</em> <a class="reference external" href="http://en.wikipedia.org/wiki/Euler%E2%80%93Lagrange_equation">http://en.wikipedia.org/wiki/Euler%E2%80%93Lagrange_equation</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">Function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.calculus.euler</span> <span class="k">import</span> <span class="n">euler_equations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">euler_equations</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">x</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">)</span>
<span class="go">[Eq(-x(t) - Derivative(x(t), t, t), 0)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">euler_equations</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">])</span>
<span class="go">[Eq(-Derivative(u(t, x), t, t) + Derivative(u(t, x), x, x), 0)]</span>
</pre></div>
</div>
</dd></dl>

<span class="target" id="module-sympy.calculus.singularities"></span><div class="section" id="singularities">
<h2>Singularities<a class="headerlink" href="#singularities" title="Permalink to this headline">¶</a></h2>
<p>This module implements algorithms for finding singularities for a function
and identifying types of functions.</p>
<p>The differential calculus methods in this module include methods to identify
the following function types in the given <code class="docutils literal"><span class="pre">Interval</span></code>:
- Increasing
- Strictly Increasing
- Decreasing
- Strictly Decreasing
- Monotonic</p>
<dl class="function">
<dt id="sympy.calculus.singularities.is_decreasing">
<code class="descclassname">sympy.calculus.singularities.</code><code class="descname">is_decreasing</code><span class="sig-paren">(</span><em>expression</em>, <em>interval=S.Reals</em>, <em>symbol=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sympy/calculus/singularities.html#is_decreasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.calculus.singularities.is_decreasing" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether the function is decreasing in the given interval.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">is_decreasing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="k">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">S</span><span class="p">,</span> <span class="n">Interval</span><span class="p">,</span> <span class="n">oo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_decreasing</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="n">Interval</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_decreasing</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="n">Interval</span><span class="o">.</span><span class="n">Lopen</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">oo</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_decreasing</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="n">Interval</span><span class="o">.</span><span class="n">Ropen</span><span class="p">(</span><span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_decreasing</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">Interval</span><span class="p">(</span><span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_decreasing</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">Interval</span><span class="p">(</span><span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.calculus.singularities.is_increasing">
<code class="descclassname">sympy.calculus.singularities.</code><code class="descname">is_increasing</code><span class="sig-paren">(</span><em>expression</em>, <em>interval=S.Reals</em>, <em>symbol=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sympy/calculus/singularities.html#is_increasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.calculus.singularities.is_increasing" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether the function is increasing in the given interval.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">is_increasing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="k">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">S</span><span class="p">,</span> <span class="n">Interval</span><span class="p">,</span> <span class="n">oo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_increasing</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">Reals</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_increasing</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">Interval</span><span class="p">(</span><span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_increasing</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_increasing</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">72</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">30</span><span class="p">,</span> <span class="n">Interval</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_increasing</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.calculus.singularities.is_monotonic">
<code class="descclassname">sympy.calculus.singularities.</code><code class="descname">is_monotonic</code><span class="sig-paren">(</span><em>expression</em>, <em>interval=S.Reals</em>, <em>symbol=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sympy/calculus/singularities.html#is_monotonic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.calculus.singularities.is_monotonic" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether the function is monotonic in the given interval.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">is_monotonic</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="k">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">S</span><span class="p">,</span> <span class="n">Interval</span><span class="p">,</span> <span class="n">oo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_monotonic</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="n">Interval</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_monotonic</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="n">Interval</span><span class="o">.</span><span class="n">Lopen</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">oo</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_monotonic</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">Reals</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_monotonic</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">Reals</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_monotonic</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.calculus.singularities.is_strictly_decreasing">
<code class="descclassname">sympy.calculus.singularities.</code><code class="descname">is_strictly_decreasing</code><span class="sig-paren">(</span><em>expression</em>, <em>interval=S.Reals</em>, <em>symbol=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sympy/calculus/singularities.html#is_strictly_decreasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.calculus.singularities.is_strictly_decreasing" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether the function is strictly decreasing in the given interval.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">is_strictly_decreasing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="k">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">S</span><span class="p">,</span> <span class="n">Interval</span><span class="p">,</span> <span class="n">oo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_strictly_decreasing</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="n">Interval</span><span class="o">.</span><span class="n">Lopen</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">oo</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_strictly_decreasing</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="n">Interval</span><span class="o">.</span><span class="n">Ropen</span><span class="p">(</span><span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_strictly_decreasing</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">Interval</span><span class="p">(</span><span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_strictly_decreasing</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">Interval</span><span class="p">(</span><span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.calculus.singularities.is_strictly_increasing">
<code class="descclassname">sympy.calculus.singularities.</code><code class="descname">is_strictly_increasing</code><span class="sig-paren">(</span><em>expression</em>, <em>interval=S.Reals</em>, <em>symbol=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sympy/calculus/singularities.html#is_strictly_increasing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.calculus.singularities.is_strictly_increasing" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether the function is strictly increasing in the given interval.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">is_strictly_increasing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="k">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">Interval</span><span class="p">,</span> <span class="n">oo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_strictly_increasing</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">72</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">30</span><span class="p">,</span> <span class="n">Interval</span><span class="o">.</span><span class="n">Ropen</span><span class="p">(</span><span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_strictly_increasing</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">72</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">30</span><span class="p">,</span> <span class="n">Interval</span><span class="o">.</span><span class="n">Lopen</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">oo</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_strictly_increasing</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">72</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">30</span><span class="p">,</span> <span class="n">Interval</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_strictly_increasing</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">Interval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_strictly_increasing</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">Interval</span><span class="p">(</span><span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.calculus.singularities.monotonicity_helper">
<code class="descclassname">sympy.calculus.singularities.</code><code class="descname">monotonicity_helper</code><span class="sig-paren">(</span><em>expression</em>, <em>predicate</em>, <em>interval=S.Reals</em>, <em>symbol=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sympy/calculus/singularities.html#monotonicity_helper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.calculus.singularities.monotonicity_helper" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function for functions checking function monotonicity.</p>
<p>It returns a boolean indicating whether the interval in which
the function’s derivative satisfies given predicate is a superset
of the given interval.</p>
</dd></dl>

<dl class="function">
<dt id="sympy.calculus.singularities.singularities">
<code class="descclassname">sympy.calculus.singularities.</code><code class="descname">singularities</code><span class="sig-paren">(</span><em>expression</em>, <em>symbol</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sympy/calculus/singularities.html#singularities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.calculus.singularities.singularities" title="Permalink to this definition">¶</a></dt>
<dd><p>Find singularities of a given function.</p>
<p>Currently supported functions are:
- univariate rational (real or complex) functions</p>
<p class="rubric">Notes</p>
<p>This function does not find nonisolated singularities
nor does it find branch points of the expression.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r23" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[R23]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/Mathematical_singularity">http://en.wikipedia.org/wiki/Mathematical_singularity</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.calculus.singularities</span> <span class="k">import</span> <span class="n">singularities</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">Symbol</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">singularities</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">EmptySet()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">singularities</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
<span class="go">{-1}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">singularities</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="p">)</span>
<span class="go">{-I, I}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">singularities</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">y</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="p">)</span>
<span class="go">{-1, 1/2 - sqrt(3)*I/2, 1/2 + sqrt(3)*I/2}</span>
</pre></div>
</div>
</dd></dl>

</div>
<span class="target" id="module-sympy.calculus.finite_diff"></span><div class="section" id="finite-difference-weights">
<h2>Finite difference weights<a class="headerlink" href="#finite-difference-weights" title="Permalink to this headline">¶</a></h2>
<p>This module implements an algorithm for efficient generation of finite
difference weights for ordinary differentials of functions for
derivatives from 0 (interpolation) up to arbitrary order.</p>
<p>The core algorithm is provided in the finite difference weight generating
function (<code class="docutils literal"><span class="pre">finite_diff_weights</span></code>), and two convenience functions are provided
for:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>estimating a derivative (or interpolate) directly from a series of points</dt>
<dd>is also provided (<code class="docutils literal"><span class="pre">apply_finite_diff</span></code>).</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>differentiating by using finite difference approximations</dt>
<dd>(<code class="docutils literal"><span class="pre">differentiate_finite</span></code>).</dd>
</dl>
</li>
</ul>
<dl class="function">
<dt id="sympy.calculus.finite_diff.apply_finite_diff">
<code class="descclassname">sympy.calculus.finite_diff.</code><code class="descname">apply_finite_diff</code><span class="sig-paren">(</span><em>order</em>, <em>x_list</em>, <em>y_list</em>, <em>x0=0</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sympy/calculus/finite_diff.html#apply_finite_diff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.calculus.finite_diff.apply_finite_diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the finite difference approximation of
the derivative of requested order at <code class="docutils literal"><span class="pre">x0</span></code> from points
provided in <code class="docutils literal"><span class="pre">x_list</span></code> and <code class="docutils literal"><span class="pre">y_list</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>order: int</strong></p>
<blockquote>
<div><p>order of derivative to approximate. 0 corresponds to interpolation.</p>
</div></blockquote>
<p><strong>x_list: sequence</strong></p>
<blockquote>
<div><p>Sequence of (unique) values for the independent variable.</p>
</div></blockquote>
<p><strong>y_list: sequence</strong></p>
<blockquote>
<div><p>The function value at corresponding values for the independent
variable in x_list.</p>
</div></blockquote>
<p><strong>x0: Number or Symbol</strong></p>
<blockquote>
<div><p>At what value of the independent variable the derivative should be
evaluated. Defaults to S(0).</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">sympy.core.add.Add or sympy.core.numbers.Number</p>
<blockquote class="last">
<div><p>The finite difference expression approximating the requested
derivative order at <code class="docutils literal"><span class="pre">x0</span></code>.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.calculus.finite_diff.finite_diff_weights" title="sympy.calculus.finite_diff.finite_diff_weights"><code class="xref py py-obj docutils literal"><span class="pre">sympy.calculus.finite_diff.finite_diff_weights</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>Order = 0 corresponds to interpolation.
Only supply so many points you think makes sense
to around x0 when extracting the derivative (the function
need to be well behaved within that region). Also beware
of Runge’s phenomenon.</p>
<p class="rubric">References</p>
<p>Fortran 90 implementation with Python interface for numerics: <a class="reference external" href="https://github.com/bjodah/finitediff">finitediff</a></p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.calculus</span> <span class="k">import</span> <span class="n">apply_finite_diff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cube</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">arg</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">*</span><span class="n">arg</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xlist</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">apply_finite_diff</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">xlist</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="n">cube</span><span class="p">,</span> <span class="n">xlist</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">12</span> 
<span class="go">-3.55271367880050e-15</span>
</pre></div>
</div>
<p>we see that the example above only contain rounding errors.
apply_finite_diff can also be used on more abstract objects:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">IndexedBase</span><span class="p">,</span> <span class="n">Idx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.calculus</span> <span class="k">import</span> <span class="n">apply_finite_diff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">IndexedBase</span><span class="p">,</span> <span class="s1">&#39;xy&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">Idx</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_list</span><span class="p">,</span> <span class="n">y_list</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">apply_finite_diff</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x_list</span><span class="p">,</span> <span class="n">y_list</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="go">((x[i + 1] - x[i])/(-x[i - 1] + x[i]) - 1)*y[i]/(x[i + 1] - x[i]) - (x[i + 1] - x[i])*y[i - 1]/((x[i + 1] - x[i - 1])*(-x[i - 1] + x[i])) + (-x[i - 1] + x[i])*y[i + 1]/((x[i + 1] - x[i - 1])*(x[i + 1] - x[i]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.calculus.finite_diff.as_finite_diff">
<code class="descclassname">sympy.calculus.finite_diff.</code><code class="descname">as_finite_diff</code><span class="sig-paren">(</span><em>derivative</em>, <em>points=1</em>, <em>x0=None</em>, <em>wrt=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sympy.calculus.finite_diff.as_finite_diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an approximation of a derivative of a function in
the form of a finite difference formula. The expression is a
weighted sum of the function at a number of discrete values of
(one of) the independent variable(s).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>derivative: a Derivative instance</strong></p>
<p><strong>points: sequence or coefficient, optional</strong></p>
<blockquote>
<div><p>If sequence: discrete values (length &gt;= order+1) of the
independent variable used for generating the finite
difference weights.
If it is a coefficient, it will be used as the step-size
for generating an equidistant sequence of length order+1
centered around <code class="docutils literal"><span class="pre">x0</span></code>. default: 1 (step-size 1)</p>
</div></blockquote>
<p><strong>x0: number or Symbol, optional</strong></p>
<blockquote>
<div><p>the value of the independent variable (<code class="docutils literal"><span class="pre">wrt</span></code>) at which the
derivative is to be approximated. Default: same as <code class="docutils literal"><span class="pre">wrt</span></code>.</p>
</div></blockquote>
<p><strong>wrt: Symbol, optional</strong></p>
<blockquote class="last">
<div><p>“with respect to” the variable for which the (partial)
derivative is to be approximated for. If not provided it
is required that the Derivative is ordinary. Default: <code class="docutils literal"><span class="pre">None</span></code>.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.calculus.finite_diff.apply_finite_diff" title="sympy.calculus.finite_diff.apply_finite_diff"><code class="xref py py-obj docutils literal"><span class="pre">sympy.calculus.finite_diff.apply_finite_diff</span></code></a>, <a class="reference internal" href="#sympy.calculus.finite_diff.finite_diff_weights" title="sympy.calculus.finite_diff.finite_diff_weights"><code class="xref py py-obj docutils literal"><span class="pre">sympy.calculus.finite_diff.finite_diff_weights</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">Function</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">as_finite_diff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.utilities.exceptions</span> <span class="k">import</span> <span class="n">SymPyDeprecationWarning</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">SymPyDeprecationWarning</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x h&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">as_finite_diff</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">-f(x - 1/2) + f(x + 1/2)</span>
</pre></div>
</div>
<p>The default step size and number of points are 1 and <code class="docutils literal"><span class="pre">order</span> <span class="pre">+</span> <span class="pre">1</span></code>
respectively. We can change the step size by passing a symbol
as a parameter:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">as_finite_diff</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">h</span><span class="p">)</span>
<span class="go">-f(-h/2 + x)/h + f(h/2 + x)/h</span>
</pre></div>
</div>
<p>We can also specify the discretized values to be used in a sequence:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">as_finite_diff</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">])</span>
<span class="go">-3*f(x)/(2*h) + 2*f(h + x)/h - f(2*h + x)/(2*h)</span>
</pre></div>
</div>
<p>The algorithm is not restricted to use equidistant spacing, nor
do we need to make the approximation around <code class="docutils literal"><span class="pre">x0</span></code>, but we can get
an expression estimating the derivative at an offset:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="p">,</span> <span class="n">sq2</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xl</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">e</span><span class="o">*</span><span class="n">h</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">as_finite_diff</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">xl</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="o">*</span><span class="n">sq2</span><span class="p">)</span>
<span class="go">2*h*((h + sqrt(2)*h)/(2*h) - (-sqrt(2)*h + h)/(2*h))*f(E*h + x)/((-h + E*h)*(h + E*h)) + (-(-sqrt(2)*h + h)/(2*h) - (-sqrt(2)*h + E*h)/(2*h))*f(-h + x)/(h + E*h) + (-(h + sqrt(2)*h)/(2*h) + (-sqrt(2)*h + E*h)/(2*h))*f(h + x)/(-h + E*h)</span>
</pre></div>
</div>
<p>Partial derivatives are also supported:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d2fdxdy</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">as_finite_diff</span><span class="p">(</span><span class="n">d2fdxdy</span><span class="p">,</span> <span class="n">wrt</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="go">-Derivative(f(x - 1/2, y), y) + Derivative(f(x + 1/2, y), y)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.calculus.finite_diff.differentiate_finite">
<code class="descclassname">sympy.calculus.finite_diff.</code><code class="descname">differentiate_finite</code><span class="sig-paren">(</span><em>expr</em>, <em>*symbols</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sympy/calculus/finite_diff.html#differentiate_finite"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.calculus.finite_diff.differentiate_finite" title="Permalink to this definition">¶</a></dt>
<dd><p>Differentiate expr and replace Derivatives with finite differences.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>expr</strong> : expression</p>
<p><strong>*symbols</strong> : differentiate with respect to symbols</p>
<p><strong>points: sequence or coefficient, optional</strong></p>
<blockquote>
<div><p>see <code class="docutils literal"><span class="pre">Derivative.as_finite_difference</span></code></p>
</div></blockquote>
<p><strong>x0: number or Symbol, optional</strong></p>
<blockquote>
<div><p>see <code class="docutils literal"><span class="pre">Derivative.as_finite_difference</span></code></p>
</div></blockquote>
<p><strong>wrt: Symbol, optional</strong></p>
<blockquote>
<div><p>see <code class="docutils literal"><span class="pre">Derivative.as_finite_difference</span></code></p>
</div></blockquote>
<p><strong>evaluate</strong> : bool</p>
<blockquote class="last">
<div><p>kwarg passed on to <code class="docutils literal"><span class="pre">diff</span></code>, whether or not to
evaluate the Derivative intermediately (default: <code class="docutils literal"><span class="pre">False</span></code>).</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">Function</span><span class="p">,</span> <span class="n">differentiate_finite</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="k">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">h</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">),</span> <span class="n">Function</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">differentiate_finite</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">points</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">])</span>
<span class="go">-f(-h + x)*g(-h + x)/(2*h) + f(h + x)*g(h + x)/(2*h)</span>
</pre></div>
</div>
<p>Note that the above form preserves the product rule in discrete form.
If we want we can pass <code class="docutils literal"><span class="pre">evaluate=True</span></code> to get another form (which is
usually not what we want):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">differentiate_finite</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">points</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">],</span> <span class="n">evaluate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="go">-((f(-h + x) - f(h + x))*g(x) + (g(-h + x) - g(h + x))*f(x))/(2*h)</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">differentiate_finite</span></code> works on any expression:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">differentiate_finite</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">-2*f(x) + f(x - 1) + f(x + 1) - 2*sin(x) + sin(x - 1) + sin(x + 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">differentiate_finite</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">evaluate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">-2*f(x) + f(x - 1) + f(x + 1) - sin(x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">differentiate_finite</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">f(x - 1/2, y - 1/2) - f(x - 1/2, y + 1/2) - f(x + 1/2, y - 1/2) + f(x + 1/2, y + 1/2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sympy.calculus.finite_diff.finite_diff_weights">
<code class="descclassname">sympy.calculus.finite_diff.</code><code class="descname">finite_diff_weights</code><span class="sig-paren">(</span><em>order</em>, <em>x_list</em>, <em>x0=1</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/sympy/calculus/finite_diff.html#finite_diff_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sympy.calculus.finite_diff.finite_diff_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the finite difference weights for an arbitrarily spaced
one-dimensional grid (<code class="docutils literal"><span class="pre">x_list</span></code>) for derivatives at <code class="docutils literal"><span class="pre">x0</span></code> of order
0, 1, …, up to <code class="docutils literal"><span class="pre">order</span></code> using a recursive formula. Order of accuracy
is at least <code class="docutils literal"><span class="pre">len(x_list)</span> <span class="pre">-</span> <span class="pre">order</span></code>, if <code class="docutils literal"><span class="pre">x_list</span></code> is defined correctly.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>order: int</strong></p>
<blockquote>
<div><p>Up to what derivative order weights should be calculated.
0 corresponds to interpolation.</p>
</div></blockquote>
<p><strong>x_list: sequence</strong></p>
<blockquote>
<div><p>Sequence of (unique) values for the independent variable.
It is useful (but not necessary) to order <code class="docutils literal"><span class="pre">x_list</span></code> from
nearest to furthest from <code class="docutils literal"><span class="pre">x0</span></code>; see examples below.</p>
</div></blockquote>
<p><strong>x0: Number or Symbol</strong></p>
<blockquote>
<div><p>Root or value of the independent variable for which the finite
difference weights should be generated. Default is <code class="docutils literal"><span class="pre">S.One</span></code>.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list</p>
<blockquote class="last">
<div><p>A list of sublists, each corresponding to coefficients for
increasing derivative order, and each containing lists of
coefficients for increasing subsets of x_list.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sympy.calculus.finite_diff.apply_finite_diff" title="sympy.calculus.finite_diff.apply_finite_diff"><code class="xref py py-obj docutils literal"><span class="pre">sympy.calculus.finite_diff.apply_finite_diff</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>If weights for a finite difference approximation of 3rd order
derivative is wanted, weights for 0th, 1st and 2nd order are
calculated “for free”, so are formulae using subsets of <code class="docutils literal"><span class="pre">x_list</span></code>.
This is something one can take advantage of to save computational cost.
Be aware that one should define <code class="docutils literal"><span class="pre">x_list</span></code> from nearest to farest from
<code class="docutils literal"><span class="pre">x0</span></code>. If not, subsets of <code class="docutils literal"><span class="pre">x_list</span></code> will yield poorer approximations,
which might not grand an order of accuracy of <code class="docutils literal"><span class="pre">len(x_list)</span> <span class="pre">-</span> <span class="pre">order</span></code>.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r24" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[R24]</a></td><td>Generation of Finite Difference Formulas on Arbitrarily Spaced
Grids, Bengt Fornberg; Mathematics of computation; 51; 184;
(1988); 699-706; doi:10.1090/S0025-5718-1988-0935077-0</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">S</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.calculus</span> <span class="k">import</span> <span class="n">finite_diff_weights</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">finite_diff_weights</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">S</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">S</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span>
<span class="go">[[[1, 0, 0, 0],</span>
<span class="go">  [1/2, 1/2, 0, 0],</span>
<span class="go">  [3/8, 3/4, -1/8, 0],</span>
<span class="go">  [5/16, 15/16, -5/16, 1/16]],</span>
<span class="go"> [[0, 0, 0, 0],</span>
<span class="go">  [-1, 1, 0, 0],</span>
<span class="go">  [-1, 1, 0, 0],</span>
<span class="go">  [-23/24, 7/8, 1/8, -1/24]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># FD weights for 0th derivative, using full x_list</span>
<span class="go">[5/16, 15/16, -5/16, 1/16]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># FD weights for 1st derivative</span>
<span class="go">[-23/24, 7/8, 1/8, -1/24]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># FD weights for 1st derivative, using x_list[:-1]</span>
<span class="go">[-1, 1, 0, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># FD weight for 1st deriv. for x_list[0]</span>
<span class="go">-23/24</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># FD weight for 1st deriv. for x_list[1], etc.</span>
<span class="go">7/8</span>
</pre></div>
</div>
<p>Each sublist contains the most accurate formula at the end.
Note, that in the above example <code class="docutils literal"><span class="pre">res[1][1]</span></code> is the same as <code class="docutils literal"><span class="pre">res[1][2]</span></code>.
Since res[1][2] has an order of accuracy of
<code class="docutils literal"><span class="pre">len(x_list[:3])</span> <span class="pre">-</span> <span class="pre">order</span> <span class="pre">=</span> <span class="pre">3</span> <span class="pre">-</span> <span class="pre">1</span> <span class="pre">=</span> <span class="pre">2</span></code>, the same is true for <code class="docutils literal"><span class="pre">res[1][1]</span></code>!</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">S</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.calculus</span> <span class="k">import</span> <span class="n">finite_diff_weights</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">finite_diff_weights</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="n">S</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span>
<span class="go">[[0, 0, 0, 0, 0],</span>
<span class="go"> [-1, 1, 0, 0, 0],</span>
<span class="go"> [0, 1/2, -1/2, 0, 0],</span>
<span class="go"> [-1/2, 1, -1/3, -1/6, 0],</span>
<span class="go"> [0, 2/3, -2/3, -1/12, 1/12]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># no approximation possible, using x_list[0] only</span>
<span class="go">[0, 0, 0, 0, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># classic forward step approximation</span>
<span class="go">[-1, 1, 0, 0, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># classic centered approximation</span>
<span class="go">[0, 1/2, -1/2, 0, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>  <span class="c1"># higher order approximations</span>
<span class="go">[[-1/2, 1, -1/3, -1/6, 0], [0, 2/3, -2/3, -1/12, 1/12]]</span>
</pre></div>
</div>
<p>Let us compare this to a differently defined <code class="docutils literal"><span class="pre">x_list</span></code>. Pay attention to
<code class="docutils literal"><span class="pre">foo[i][k]</span></code> corresponding to the gridpoint defined by <code class="docutils literal"><span class="pre">x_list[k]</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">S</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.calculus</span> <span class="k">import</span> <span class="n">finite_diff_weights</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">foo</span> <span class="o">=</span> <span class="n">finite_diff_weights</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">S</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">S</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">foo</span>
<span class="go">[[0, 0, 0, 0, 0],</span>
<span class="go"> [-1, 1, 0, 0, 0],</span>
<span class="go"> [1/2, -2, 3/2, 0, 0],</span>
<span class="go"> [1/6, -1, 1/2, 1/3, 0],</span>
<span class="go"> [1/12, -2/3, 0, 2/3, -1/12]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">foo</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># not the same and of lower accuracy as res[1]!</span>
<span class="go">[-1, 1, 0, 0, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">foo</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># classic double backward step approximation</span>
<span class="go">[1/2, -2, 3/2, 0, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">foo</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>  <span class="c1"># the same as res[4]</span>
<span class="go">[1/12, -2/3, 0, 2/3, -1/12]</span>
</pre></div>
</div>
<p>Note that, unless you plan on using approximations based on subsets of
<code class="docutils literal"><span class="pre">x_list</span></code>, the order of gridpoints does not matter.</p>
<p>The capability to generate weights at arbitrary points can be
used e.g. to minimize Runge’s phenomenon by using Chebyshev nodes:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">simplify</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.calculus</span> <span class="k">import</span> <span class="n">finite_diff_weights</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span><span class="p">,</span> <span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;h x&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="c1"># chebyshev nodes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x_list</span><span class="p">)</span>
<span class="go">[-h + x, -sqrt(2)*h/2 + x, x, sqrt(2)*h/2 + x, h + x]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mycoeffs</span> <span class="o">=</span> <span class="n">finite_diff_weights</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x_list</span><span class="p">,</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">simplify</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span>  <span class="n">mycoeffs</span><span class="p">]</span> 
<span class="go">[(h**3/2 + h**2*x - 3*h*x**2 - 4*x**3)/h**4,</span>
<span class="go">(-sqrt(2)*h**3 - 4*h**2*x + 3*sqrt(2)*h*x**2 + 8*x**3)/h**4,</span>
<span class="go">6*x/h**2 - 8*x**3/h**4,</span>
<span class="go">(sqrt(2)*h**3 - 4*h**2*x - 3*sqrt(2)*h*x**2 + 8*x**3)/h**4,</span>
<span class="go">(-h**3/2 + h**2*x + 3*h*x**2 - 4*x**3)/h**4]</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/sympylogo.png" alt="Logo"/>
            </a></p>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Calculus</a><ul>
<li><a class="reference internal" href="#singularities">Singularities</a></li>
<li><a class="reference internal" href="#finite-difference-weights">Finite difference weights</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../parsing.html"
                        title="previous chapter">Parsing input</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../physics/index.html"
                        title="next chapter">Physics Module</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/modules/calculus/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../physics/index.html" title="Physics Module"
             >next</a> |</li>
        <li class="right" >
          <a href="../parsing.html" title="Parsing input"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">SymPy 1.1.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >SymPy Modules Reference</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017 SymPy Development Team.
      Last updated on Jul 27, 2017.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
  </body>
</html>